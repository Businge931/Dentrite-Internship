{"ast":null,"code":"import _regeneratorRuntime from \"D:/Dentrait/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/Dentrait/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { configureStore } from \"@reduxjs/toolkit\";\nimport { FAVOURITE_PLAYLIST_ID } from \"../constants/constants\";\nimport { SET_LOADING_STATE, SET_SONGS_LIST, UPDATE_ERROR_STATE } from \"./Actions\";\nimport { MusicAppReducer } from \"./Reducers\";\nexport var initialState = {\n  songsList: [],\n  activeFilters: [],\n  playLists: [{\n    id: FAVOURITE_PLAYLIST_ID,\n    title: \"Favourites\",\n    songs: []\n  }],\n  searchTerm: \"\",\n  isLoading: false,\n  isError: false\n};\nvar rootReducer = new MusicAppReducer().reducer();\nexport var rootStore = configureStore({\n  reducer: rootReducer,\n  middleware: function middleware(getDefaultMiddleware) {\n    return getDefaultMiddleware({\n      serializableCheck: false\n    });\n  }\n});\nexport var connectInfraToStore = {\n  _musicFacade: null\n};\nexport var fetchSongList = function fetchSongList(listSize) {\n  return /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch) {\n      var result;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            dispatch(SET_LOADING_STATE(true));\n            if (!connectInfraToStore._musicFacade) {\n              _context.next = 8;\n              break;\n            }\n            _context.next = 4;\n            return connectInfraToStore._musicFacade.fetchSongs(listSize);\n          case 4:\n            result = _context.sent;\n            if (Array.isArray(result)) {\n              dispatch(SET_SONGS_LIST(result));\n            } else {\n              // Handle server failure\n              dispatch(UPDATE_ERROR_STATE(true));\n            }\n            _context.next = 10;\n            break;\n          case 8:\n            console.error(\"Has not initialised facade bridge\");\n            dispatch(UPDATE_ERROR_STATE(true));\n          case 10:\n            dispatch(SET_LOADING_STATE(false));\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee);\n    }));\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};","map":{"version":3,"names":["configureStore","FAVOURITE_PLAYLIST_ID","SET_LOADING_STATE","SET_SONGS_LIST","UPDATE_ERROR_STATE","MusicAppReducer","initialState","songsList","activeFilters","playLists","id","title","songs","searchTerm","isLoading","isError","rootReducer","reducer","rootStore","middleware","getDefaultMiddleware","serializableCheck","connectInfraToStore","_musicFacade","fetchSongList","listSize","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","result","wrap","_callee$","_context","prev","next","fetchSongs","sent","Array","isArray","console","error","stop","_x","apply","arguments"],"sources":["D:/Dentrait/src/application/music/redux/MusicStore.ts"],"sourcesContent":["import { configureStore } from \"@reduxjs/toolkit\";\nimport { IMusicFacade } from \"../../../domain/music/IMusicFacade\";\nimport { PlayList, Song } from \"../../../domain/music/ValueObjects\";\nimport { FAVOURITE_PLAYLIST_ID } from \"../constants/constants\";\nimport {\n  SET_LOADING_STATE,\n  SET_SONGS_LIST,\n  UPDATE_ERROR_STATE\n} from \"./Actions\";\nimport { MusicAppReducer } from \"./Reducers\";\n\nexport type Filters = \"title\" | \"artist\" | \"release_date\";\nexport type MusicAppState = {\n  songsList: Song[];\n  activeFilters: Filters[];\n  playLists: PlayList[];\n  searchTerm: string;\n  isLoading: boolean;\n  isError: boolean;\n};\n\nexport const initialState = {\n  songsList: [],\n  activeFilters: [],\n  playLists: [\n    {\n      id: FAVOURITE_PLAYLIST_ID,\n      title: \"Favourites\",\n      songs: []\n    }\n  ],\n  searchTerm: \"\",\n  isLoading: false,\n  isError: false\n};\n\ntype InfraToStoreBridge = {\n  _musicFacade: IMusicFacade | null;\n};\n\nconst rootReducer = new MusicAppReducer().reducer();\n\nexport const rootStore = configureStore({\n  reducer: rootReducer,\n  middleware: (getDefaultMiddleware) =>\n    getDefaultMiddleware({\n      serializableCheck: false\n    })\n});\n\nexport type AppDispatch = typeof rootStore.dispatch;\n\nexport const connectInfraToStore: InfraToStoreBridge = {\n  _musicFacade: null\n};\n\nexport const fetchSongList = (listSize: number) => async (\n  dispatch: AppDispatch\n) => {\n  dispatch(SET_LOADING_STATE(true));\n  if (connectInfraToStore._musicFacade) {\n    const result = await connectInfraToStore._musicFacade.fetchSongs(listSize);\n    if (Array.isArray(result)) {\n      dispatch(SET_SONGS_LIST(result));\n    } else {\n      // Handle server failure\n      dispatch(UPDATE_ERROR_STATE(true));\n    }\n  } else {\n    console.error(\"Has not initialised facade bridge\");\n    dispatch(UPDATE_ERROR_STATE(true));\n  }\n  dispatch(SET_LOADING_STATE(false));\n};\n"],"mappings":";;AAAA,SAASA,cAAc,QAAQ,kBAAkB;AAGjD,SAASC,qBAAqB,QAAQ,wBAAwB;AAC9D,SACEC,iBAAiB,EACjBC,cAAc,EACdC,kBAAkB,QACb,WAAW;AAClB,SAASC,eAAe,QAAQ,YAAY;AAY5C,OAAO,IAAMC,YAAY,GAAG;EAC1BC,SAAS,EAAE,EAAE;EACbC,aAAa,EAAE,EAAE;EACjBC,SAAS,EAAE,CACT;IACEC,EAAE,EAAET,qBAAqB;IACzBU,KAAK,EAAE,YAAY;IACnBC,KAAK,EAAE;EACT,CAAC,CACF;EACDC,UAAU,EAAE,EAAE;EACdC,SAAS,EAAE,KAAK;EAChBC,OAAO,EAAE;AACX,CAAC;AAMD,IAAMC,WAAW,GAAG,IAAIX,eAAe,EAAE,CAACY,OAAO,EAAE;AAEnD,OAAO,IAAMC,SAAS,GAAGlB,cAAc,CAAC;EACtCiB,OAAO,EAAED,WAAW;EACpBG,UAAU,EAAE,SAAAA,WAACC,oBAAoB;IAAA,OAC/BA,oBAAoB,CAAC;MACnBC,iBAAiB,EAAE;IACrB,CAAC,CAAC;EAAA;AACN,CAAC,CAAC;AAIF,OAAO,IAAMC,mBAAuC,GAAG;EACrDC,YAAY,EAAE;AAChB,CAAC;AAED,OAAO,IAAMC,aAAa,GAAG,SAAhBA,aAAaA,CAAIC,QAAgB;EAAA;IAAA,IAAAC,IAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAK,SAAAC,QACjDC,QAAqB;MAAA,IAAAC,MAAA;MAAA,OAAAJ,mBAAA,GAAAK,IAAA,UAAAC,SAAAC,QAAA;QAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;UAAA;YAErBN,QAAQ,CAAC7B,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAAC,KAC9BoB,mBAAmB,CAACC,YAAY;cAAAY,QAAA,CAAAE,IAAA;cAAA;YAAA;YAAAF,QAAA,CAAAE,IAAA;YAAA,OACbf,mBAAmB,CAACC,YAAY,CAACe,UAAU,CAACb,QAAQ,CAAC;UAAA;YAApEO,MAAM,GAAAG,QAAA,CAAAI,IAAA;YACZ,IAAIC,KAAK,CAACC,OAAO,CAACT,MAAM,CAAC,EAAE;cACzBD,QAAQ,CAAC5B,cAAc,CAAC6B,MAAM,CAAC,CAAC;YAClC,CAAC,MAAM;cACL;cACAD,QAAQ,CAAC3B,kBAAkB,CAAC,IAAI,CAAC,CAAC;YACpC;YAAC+B,QAAA,CAAAE,IAAA;YAAA;UAAA;YAEDK,OAAO,CAACC,KAAK,CAAC,mCAAmC,CAAC;YAClDZ,QAAQ,CAAC3B,kBAAkB,CAAC,IAAI,CAAC,CAAC;UAAC;YAErC2B,QAAQ,CAAC7B,iBAAiB,CAAC,KAAK,CAAC,CAAC;UAAC;UAAA;YAAA,OAAAiC,QAAA,CAAAS,IAAA;QAAA;MAAA,GAAAd,OAAA;IAAA,CACpC;IAAA,iBAAAe,EAAA;MAAA,OAAAnB,IAAA,CAAAoB,KAAA,OAAAC,SAAA;IAAA;EAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}